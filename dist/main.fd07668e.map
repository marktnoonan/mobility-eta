{"version":3,"sources":["js/helpers.js","js/main.js"],"names":["today","username","toLowerCase","console","log","Date","getFullYear","getMonth","length","getDate","convertTimeToMinutes","time","split","hours","minutes","parseInt","getCurrentTime","date","getHours","getMinutes","convertFromMilitaryTime","standardHours","period","charAt","substring","dateHelper","days","months","prettyDate","getDay","etaColors","yellow","green","red","blue","orange","martaResponse","bookings","clientName","loginDetails","todaysDate","init","addLogInListeners","showInfo","password","document","querySelector","innerHTML","helpers","showSpinner","getTrips","addTryAgainScreen","usernameInput","passwordInput","addEventListener","value","event","keyCode","addRefreshListener","refreshButton","Promise","resolve","reject","xhr","XMLHttpRequest","open","setRequestHeader","onload","readyState","status","handleMartaData","responseText","Error","statusText","send","xhrResponse","tripDataString","JSON","parse","tripDataArray","todaysTripData","find","trip","data","trips","pickupLocationData","pickup","location","dropoffLocationData","dropoff","nextTripInfo","bookingID","id","readyTime","negotiatedTimeEarly","endWindow","negotiatedTimeLate","eta","estimatedTime","etaInMinutes","endWindowInMinutes","currentTimeInMinutes","displayEta","displayReadyTime","displayEndWindow","displayDate","pickupAddress","streetNumber","onStreet","city","state","postalCode","dropOffAddress","delayInMinutes","statusColor","getStatusColor","statusDescription","getStatusDescription","delayInMinutesDescription","getDelayInMinutesDescription","showTrip","setMarker","retryLogin","possibleStatuses","delay","Math","abs","tripDetails","busImageURL","marker","tooltip","progressWrapper","lateMins","markerPixels","markerDistance","tooltipMargin","remainingDistance","borderStyle","style","borderLeft","borderRight","marginLeft","display","spinner"],"mappings":"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","file":"main.fd07668e.map","sourceRoot":"..","sourcesContent":["export default {\n\ttoday(username) {\n\t\t//matches the format in MARTA's data\n\t\tif (username.toLowerCase() === 'test') {\n\t\t\tconsole.log('test user logged in')\n\t\t\treturn '2018-04-10' // important for demo\n\t\t} else {\n\t\t\tconst today = new Date()\n\t\t\treturn `${today.getFullYear()}-${\n\t\t\t\ttoday.getMonth.length < 10 ? 0 : ''\n\t\t\t}${today.getMonth() + 1}-${today.getDate()}`\n\t\t}\n\t},\n\n\tconvertTimeToMinutes(time) {\n\t\tlet [hours, minutes] = time.split(':')\n\t\treturn parseInt(hours) * 60 + parseInt(minutes)\n\t},\n\n\tgetCurrentTime() {\n\t\tconst date = new Date()\n\t\treturn `${date.getHours()}:${date.getMinutes()}`\n\t},\n\n\tconvertFromMilitaryTime(time) {\n\t\tconst [hours, minutes] = time.split(':')\n\t\tlet standardHours = hours > 12 ? hours % 12 : hours\n\t\tlet period = hours < 12 ? 'AM' : 'PM'\n\t\tif (hours < 12 && standardHours.charAt(0) === '0') {\n\t\t\tstandardHours = standardHours.substring(1)\n\t\t}\n\t\treturn `${standardHours}:${minutes} ${period}`\n\t},\n\n\tdateHelper: {\n\t\tdays: [\n\t\t\t'Sunday',\n\t\t\t'Monday',\n\t\t\t'Tuesday',\n\t\t\t'Wednesday',\n\t\t\t'Thursday',\n\t\t\t'Friday',\n\t\t\t'Saturday'\n\t\t],\n\t\tmonths: [\n\t\t\t'January',\n\t\t\t'February',\n\t\t\t'March',\n\t\t\t'April',\n\t\t\t'May',\n\t\t\t'June',\n\t\t\t'July',\n\t\t\t'August',\n\t\t\t'September',\n\t\t\t'October',\n\t\t\t'November',\n\t\t\t'December'\n\t\t],\n\t\tprettyDate(date) {\n\t\t\treturn `${this.days[date.getDay()]}, ${\n\t\t\t\tthis.months[date.getMonth()]\n\t\t\t} ${date.getDate()}`\n\t\t}\n\t}\n}\n","import helpers from './helpers'\nimport busImageURL from '../assets/bus.png'\n\nvar etaColors = {\n\tyellow: '#d69400',\n\tgreen: '#8AB755',\n\tred: '#FC7455',\n\tblue: '#00BBE5',\n\torange: '#F79044'\n}\nvar martaResponse = {}\nvar bookings = []\nvar clientName = ''\nvar loginDetails = []\nvar todaysDate = ''\n;(function init() {\n\taddLogInListeners()\n})()\n\nfunction showInfo(username, password) {\n\tdocument.querySelector('#intro-text').innerHTML =\n\t\t'<h3 txt=\"c\"> Your Next Trip </h3>'\n\ttodaysDate = helpers.today(username)\n\tshowSpinner()\n\tloginDetails = [username, password]\n\tgetTrips(username, password)\n}\n\nfunction addTryAgainScreen() {\n\tdocument.querySelector('#mobility-eta').innerHTML =\n\t\t'<div class=\"form-wrapper\" style=\"text-align:center; margin-top: 20px; margin-bottom: 40px;\"><form class=\"\" id=\"unpw-form\" method=\"post\"> <h1 style=\"margin-bottom: 40px;\"> Log In </h1> <p style=\"color:' +\n\t\tetaColors.red +\n\t\t'\">Username or Password was not found, please try again:</p><input type=\"text\" name=\"providedUsername\" value=\"\" placeholder=\"Client ID\" style=\"font-size:18px; padding: 3px\"> <br><br> <input type=\"password\" name=\"providedPassword\" id=\"pw\" value=\"\" placeholder=\"Password\" style=\"font-size:18px; padding: 3px\"> <br><br><br> </form> <button type=\"button\" id=\"login\" style=\"background-color: #333; border: 2px solid #333; color: #fff; display: inline-block; font-size: 14px; font-weight: 700; line-height: 1.2; padding: 11px 20px; position: relative; cursor: pointer;\">Check My Trips</button><div id=\"output\"><br><span style=\"color:' +\n\t\tetaColors.red +\n\t\t'\">WARNING: This is site is in a pilot mode. Some errors may still exist. If trip information is unclear or looks wrong, you may confirm with MARTA Mobility ETA by phone: 404-848-4212.</span><br><br> If you do not know your Client ID or Password, you can call Reservations at (404) 848-5826.<br><br> For a demo, enter username <b>test</b> and password <b>test</b>. Contact markthomasnoonan@gmail.com with questions or feedback. </div></div> </div>'\n}\n\nfunction addLogInListeners() {\n\tvar usernameInput = document.querySelector('input[name=providedUsername]')\n\tvar passwordInput = document.querySelector('input[name=providedPassword]')\n\n\tdocument.querySelector('#login').addEventListener('click', function() {\n\t\tvar username = usernameInput.value\n\t\tvar password = passwordInput.value\n\t\tshowInfo(username, password)\n\t})\n\n\tdocument.querySelector('#pw').addEventListener('keyup', function(event) {\n\t\tif (event.keyCode == 13) {\n\t\t\tvar username = usernameInput.value\n\t\t\tvar password = passwordInput.value\n\t\t\tshowInfo(username, password)\n\t\t}\n\t})\n}\n\nfunction addRefreshListener() {\n\tvar refreshButton = document.querySelector('#refresh-button')\n\trefreshButton.addEventListener('click', function() {\n\t\tshowInfo(loginDetails[0], loginDetails[1])\n\t})\n}\n\nfunction getTrips(username, password) {\n\treturn new Promise(function(resolve, reject) {\n\t\tvar xhr = new XMLHttpRequest()\n\t\txhr.open(\n\t\t\t'POST',\n\t\t\t'https://markthomasnoonan.com/mobility-eta/scrape.php',\n\t\t\ttrue\n\t\t)\n\t\txhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded')\n\t\txhr.onload = function() {\n\t\t\tif (xhr.readyState == 4 && xhr.status === 200) {\n\t\t\t\tresolve(handleMartaData(xhr.responseText))\n\t\t\t} else {\n\t\t\t\treject(Error('Request failed, status was ' + xhr.statusText))\n\t\t\t}\n\t\t}\n\t\txhr.send('providedUsername=' + username + '&providedPassword=' + password)\n\t})\n}\n\nfunction handleMartaData(xhrResponse) {\n\tvar tripDataString = JSON.parse(xhrResponse)\n\tvar tripDataArray = JSON.parse(tripDataString)\n\tvar todaysTripData = tripDataArray.find(trip => {\n\t\treturn trip.date === todaysDate\n\t}).data.trips[0].trips[0] // need to work on this.\n\tconst pickupLocationData = todaysTripData.pickup.location\n\tconst dropoffLocationData = todaysTripData.dropoff.location\n\tvar nextTripInfo = {\n\t\tbookingID: todaysTripData.id,\n\t\treadyTime: todaysTripData.pickup.negotiatedTimeEarly.substring(0, 5),\n\t\tendWindow: todaysTripData.pickup.negotiatedTimeLate.substring(0, 5),\n\t\teta: todaysTripData.pickup.estimatedTime.substring(0, 5),\n\t\tstatus: '',\n\t\tetaInMinutes: '',\n\t\tendWindowInMinutes: '',\n\t\tcurrentTimeInMinutes: helpers.convertTimeToMinutes(\n\t\t\thelpers.getCurrentTime()\n\t\t),\n\t\tdisplayEta: '',\n\t\tdisplayReadyTime: '',\n\t\tdisplayEndWindow: '',\n\t\tdisplayDate: helpers.dateHelper.prettyDate(new Date()),\n\t\tpickupAddress: `${pickupLocationData.streetNumber} ${\n\t\t\tpickupLocationData.onStreet\n\t\t}<br> ${pickupLocationData.city}, ${pickupLocationData.state} ${\n\t\t\tpickupLocationData.postalCode\n\t\t}`,\n\t\tdropOffAddress: `${dropoffLocationData.streetNumber} ${\n\t\t\tdropoffLocationData.onStreet\n\t\t}<br> ${dropoffLocationData.city}, ${dropoffLocationData.state} ${\n\t\t\tdropoffLocationData.postalCode\n\t\t}`\n\t}\n\n\tnextTripInfo.etaInMinutes = helpers.convertTimeToMinutes(nextTripInfo.eta)\n\tnextTripInfo.endWindowInMinutes = helpers.convertTimeToMinutes(\n\t\tnextTripInfo.endWindow\n\t)\n\tnextTripInfo.displayEta = helpers.convertFromMilitaryTime(nextTripInfo.eta)\n\tnextTripInfo.displayReadyTime = helpers.convertFromMilitaryTime(\n\t\tnextTripInfo.readyTime\n\t)\n\tnextTripInfo.displayEndWindow = helpers.convertFromMilitaryTime(\n\t\tnextTripInfo.endWindow\n\t)\n\tnextTripInfo.delayInMinutes =\n\t\t30 - (nextTripInfo.endWindowInMinutes - nextTripInfo.etaInMinutes)\n\n\tnextTripInfo.statusColor = getStatusColor(nextTripInfo.delayInMinutes)\n\tnextTripInfo.statusDescription = getStatusDescription(\n\t\tnextTripInfo.delayInMinutes\n\t)\n\tnextTripInfo.delayInMinutesDescription = getDelayInMinutesDescription(\n\t\tnextTripInfo.delayInMinutes\n\t)\n\n\tdocument.querySelector('#mobility-eta').innerHTML = showTrip(nextTripInfo)\n\tsetMarker(nextTripInfo)\n}\n\nfunction retryLogin() {\n\taddTryAgainScreen()\n\taddLogInListeners()\n}\n\nconst possibleStatuses = [\n\t'unscheduled',\n\t'scheduled',\n\t'inprogress',\n\t'complete',\n\t'noshow',\n\t'cancelled',\n\t'willcall',\n\t'imminent'\n]\n\nfunction getStatusColor(delay) {\n\tconsole.log(delay)\n\tif (delay > 30) {\n\t\treturn 'red'\n\t} else if (delay < 30 && delay > 0) {\n\t\treturn 'yellow'\n\t} else {\n\t\treturn 'green'\n\t}\n}\n\nfunction getStatusDescription(delay) {\n\tconsole.log(delay)\n\tif (delay > 30) {\n\t\treturn 'Running late.'\n\t} else if (delay < 30 && delay > 0) {\n\t\treturn 'Arriving in window.'\n\t} else {\n\t\treturn 'Arriving on time.'\n\t}\n}\n\nfunction getDelayInMinutesDescription(delay) {\n\tif (delay > 1) {\n\t\treturn `${delay} minutes after Ready Time.`\n\t} else if (delay == 1) {\n\t\treturn '1 minute after Ready Time.'\n\t} else if (delay < -1) {\n\t\treturn Math.abs(delay) + ' minutes before Ready Time.'\n\t} else if (delay == -1) {\n\t\treturn '1 minute before Ready Time.'\n\t} else if (delay == 0) {\n\t\treturn 'right on time.'\n\t}\n}\n\nfunction showTrip(tripDetails) {\n\treturn `\n    <card full class=\"booking\" id=\"booking0\">\n\t\t\t<div class=\"date-and-id\" id=\"date-and-id\">\n\t\t\t\t<span class=\"display-date\">\n          <h2 style=\"border:0; margin-bottom: 4px; margin-top: 12px\">\n            <b>${tripDetails.displayDate}</b>\n          </h2>\n        </span>\n\t\t\t\t<span>\n          <b>Booking ID</b>: ${tripDetails.bookingID}</span> |\n\t\t\t\t<span>\n          <b>Ready Time</b>: ${tripDetails.displayReadyTime}</span>\n\t\t\t</div>\n\t\t\t<div class=\"booking-status\" style=\"margin-top: 8px; margin-bottom: 7px;\">\n\t\t\t\t<span style=\"font-weight:bold; font-size: 16px;\">Trip Status</span>\n\t\t\t\t<br>\n\t\t\t\t<span class=\"late-status\" style=\"border-radius: 3px; padding: 4px; color:${\n\t\t\t\t\tetaColors[tripDetails.statusColor]\n\t\t\t\t}\">${tripDetails.statusDescription}</span>\n\t\t\t</div>\n\t\t\t<div class=\"progress-wrapper\" style=\"display: inline-block; font-size: 12px;\">\n\t\t\t\t<div class=\"labels\" style=\"padding-top: 3px; text-align: left; line-height: 1.2; margin-left: -6px;\">\n\t\t\t\t\t<div class=\"label left\" style=\"width: auto;text-align: left;display: inline-block;padding: 0;\">\n\t\t\t\t\t\t<span class=\"tool-tip\" style=\"border-radius: 3px;display: inline-block;padding: 3px;margin-bottom: -2px;\">\n              <b>Start Window</b>\n              <br>${tripDetails.displayReadyTime}</span>\n\t\t\t\t\t\t<div class=\"down-arrow\" style=\" position: relative; height: 10px; width: 10px;  transform: translate(6px, -3px) rotate(45deg); \"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"label center\" style=\"width: auto;text-align: left;display: inline-block;transform: translateX(45px);padding: 0\">\n\t\t\t\t\t\t<span class=\"tool-tip\" style=\"border-radius: 3px;display: inline-block;padding: 3px;margin-bottom: -2px;\">\n              <b>End Window</b>\n              <br>${tripDetails.displayEndWindow}</span>\n\t\t\t\t\t\t<div class=\"down-arrow\" style=\" position: relative; height: 10px; width: 10px; transform: translate(6px, -3px) rotate(45deg); \"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"outer\" style=\"text-align: left; width: 240px; background-color: #111; border-radius: 10px; overflow: hidden;\">\n\t\t\t\t\t<div class=\"inner\" style=\"height: 26px; background-color: #595; background: linear-gradient(to right, #595 0%, #ee5 50%, #f55 80%);\">\n\t\t\t\t\t\t<span class=\"eta label\" style=\"position: relative;display: inline-block;box-sizing: border-box;height: 100%;padding-top: 5px;text-align: left;transform: translateY(-5px);\" aria-hidden=\"true\">\n              <img src=\"${busImageURL}\" id=\"martabus\" style=\"height: 26px;padding: 0px 5px 0px 0px; border-left: 108px solid rgba(100, 100, 100, 0.5); border-right: 104px solid rgba(100, 100, 100, 0.5);\"\n                alt=\"\">\n            </span>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"eta-tooltip\" style=\"width: auto; text-align: left; position: absolute; margin-top: 4px; margin-left: 100px;\">\n\t\t\t\t\t<div class=\"up-arrow\" style=\" position: relative; height: 10px; width: 10px; transform: translate(4px, 0px) rotate(45deg); \"></div>\n\t\t\t\t\t<span class=\"tool-tip\" style=\"border-radius: 3px;display: inline-block;padding: 3px;transform: translateY(-6px); line-height:1.2\">\n            <b>Your ETA</b>\n            <br>${tripDetails.displayEta}</span>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<span class=\"eta-wrapper\" style=\"margin-top: 44px; display: inline-block; font-size: 14px; line-height: 1.3\">Bus expected at\n        <b>${tripDetails.displayEta}</b>,\n        <br>${tripDetails.delayInMinutesDescription}</span>\n\t\t\t<div class=\"ready-time-gage\" style=\"text-align: left\">\n\t\t\t<br>\n\t\t\t\t<div class=\"pickup\">\n\t\t\t\t\t<b>Pick Up</b>\n\t\t\t\t\t<br>${tripDetails.pickupAddress}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"dropoff\">\n\t\t\t\t\t<b>Drop Off</b>\n          <br>${tripDetails.dropOffAddress}\n          </div>\n\t\t\t\t<br>\n\t\t\t</div>\n\t\t</card>\n    `\n}\n\nfunction setMarker(tripDetails) {\n\tvar marker = document.querySelector('#martabus')\n\tvar tooltip = document.querySelector('.eta-tooltip')\n\tvar progressWrapper = document.querySelector('.progress-wrapper')\n\tvar lateMins = tripDetails.delayInMinutes\n\tvar markerPixels = lateMins * 4\n\tvar markerDistance = markerPixels\n\tvar tooltipMargin = 0\n\tvar remainingDistance = 0\n\tvar borderStyle = ' solid rgba(100,100,100,0.5)'\n\n\t// to account for being very late.\n\tif (markerDistance < 234) {\n\t\tmarkerDistance += 'px'\n\t\tremainingDistance = 240 - markerPixels - 28 + 'px'\n\t} else {\n\t\tmarkerDistance = '220' + 'px'\n\t}\n\n\t//to manage marker boundaries\n\tif (markerPixels < -16) {\n\t\ttooltipMargin = '-16px'\n\t} else if (markerPixels > 215) {\n\t\ttooltipMargin = '216px'\n\t} else {\n\t\ttooltipMargin = markerPixels - 8 + 'px'\n\t}\n\n\t// position everything\n\tmarker.style.borderLeft = markerDistance + borderStyle\n\tmarker.style.borderRight = remainingDistance + borderStyle\n\ttooltip.style.marginLeft = tooltipMargin\n\tprogressWrapper.style.display = 'inline-block'\n}\n\nfunction showSpinner() {\n\tvar spinner =\n\t\t'<style>@-webkit-keyframes sweep { to { -webkit-transform: rotate(360deg); } }</style><div id=\"spinner\" style=\"width: 50px; height: 50px; -webkit-animation: sweep 1s infinite linear; border-radius: 75px; border-bottom: 5px solid #00bbe5; margin: 50px auto\"></div><div style=\"margin: 20px auto; display: inline-block\">Loading your trips...</div>'\n\tdocument.querySelector('#mobility-eta').innerHTML = spinner\n}\n"]}